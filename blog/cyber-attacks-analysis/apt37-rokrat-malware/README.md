# North Korean APT37 Targets South Korean Officials With RokRAT in Operation HanKook Phantom

## Overview

As a security researcher with years of experience tracking state-sponsored threats, I've closely examined various reports on Operation HanKook Phantom. This campaign exemplifies the evolving tactics of North Korean advanced persistent threats (APTs), particularly APT37, in their relentless pursuit of intelligence on South Korean affairs. Named "HanKook Phantom" to evoke Korea ("HanKook" in Korean) and the ghostly evasion techniques employed, the operation underscores the group's sophistication in blending social engineering with technical stealth. While the provided report offers a solid foundation, additional sources confirm this as part of broader APT37 activities in 2023–2025, including overlaps with campaigns targeting defectors and military alliances.

## Historical and Geopolitical Context

North Korea's cyber operations, often state-directed, aim to gather intelligence amid escalating tensions on the Korean Peninsula. APT37's activities date back to at least 2012, with a focus on South Korea but expanding to Japan, Vietnam, Russia, and beyond. The timing of HanKook Phantom, aligned with inter-Korean diplomatic strains, such as North Korea's rejection of reconciliation under South Korean leadership, suggests opportunistic exploitation of current events. Decoys reference real issues like North Korean troop deployments to Russia and policy critiques, making them highly credible to targets.

External research, including reports from Mandiant and Microsoft Threat Intelligence, corroborates APT37's use of similar lures in 2024 campaigns, such as phishing defectors with HWP documents. No major breaches from this specific operation have been publicly disclosed as of September 2025, but it fits a pattern of low-and-slow espionage rather than disruptive attacks.

## Threat Actor Profile

### APT37 (Reaper, ScarCruft, InkySquid)

APT37 is a prolific North Korean espionage group, linked to the Reconnaissance General Bureau (RGB), Pyongyang's primary intelligence arm.

- **Operational Focus**: Cyber espionage targeting government, defense, and academia, with spear-phishing as the entry vector.
- **Evolution**: Started with simple malware drops; now employs fileless techniques, cloud C2, and custom RATs like ROKRAT (a modular backdoor for command execution and exfiltration).
- **Geographic Reach**: Primarily South Korea (e.g., intelligence societies, universities like Kwangwoon and Korea University), but extends to Japan, Vietnam, Russia, Nepal, China, India, Romania, Kuwait, and Middle Eastern entities.
- **Attribution Indicators**: Use of Korean-language decoys, XOR encryption with simple keys (e.g., ASCII `'5'` or `'7'`), and C2 via legitimate cloud providers to blend traffic.

Recent analyses (e.g., from CrowdStrike's 2025 Global Threat Report) note APT37's increased use of LNK files post-2023, possibly in response to improved PDF sandboxing. They adapt quickly, renaming payloads (e.g., `aio*.dat` to `tony*.dat`) to evade signatures.

## Campaign Details: Two-Phased Spear-Phishing Attacks

The operation comprises two campaigns, both delivered via email archives containing a legitimate PDF decoy and a malicious LNK file (`"국가정보연구회 소식지(52호).pdf.lnk"`). Victims, likely from targeted sectors, receive these as "updates" or "statements," exploiting trust in official sources.

### Campaign 1: National Intelligence Research Society Newsletter Decoy

#### Decoy Analysis

The lure is Issue 52 of the "National Intelligence Research Society Newsletter" (국가정보연구회 소식지 52호), a real monthly publication from a South Korean group discussing intelligence, labor relations, security, energy, and North-South Korea ties. Dated around March 2021 but reused, it covers seminars, events, AI developments, and financial reminders tailored to engage academics and officials.

#### Targets

- National Intelligence Research Association
- Kwangwoon University and Korea University
- Institute for National Security Strategy
- Central Labor Economic Research Institute
- Energy Security and Environment Association
- Republic of Korea National Salvation Spirit Promotion Association
- Yangjihoe (memorial conference hosts)
- Korea Integration Strategy groups

#### Infection Chain

1. User downloads ZIP with decoy PDF and LNK.

   - LNK is a Windows "shortcut" file. It's normally used to point to another file (like on your desktop). But in this case, it's been weaponized.
   - Instead of just pointing to a file, its properties have been edited to run a command (like PowerShell) when you double-click it. It's a Trojan horse that looks like a document.

2. Executes LNK, triggering embedded PowerShell to extract payloads from LNK binary offsets (e.g., `0x0000102C` for fake PDF, `0x0007EDC1` for `aio1.dat`).

   - A command is hidden inside the LNK file's properties. When you click the LNK, it doesn't open a document; it opens a PowerShell window and tells it to run this specific, hidden command.
   - The PowerShell command's job is to find the hidden malicious payloads inside the LNK file, copy them out, and save them as separate files on your computer's hard drive (in the `%TEMP%` folder).
   - All computer files are made of binary data (1s and 0s). You can think of the LNK file as a long, long string of numbers.
   - The binary offset is an "address" or "position" of a specific piece of data within that long string. It's like the exact centimeter mark on a ruler.
   - `0x0000102C` is a hexadecimal number (that's what the `0x` means) that tells PowerShell to "Start reading the data at position 1,004th byte in the file."
   - The next offset, `0x0007EDC1`, tells it to start reading another payload at the 519,617th byte.
   - Hackers use offsets because it's a stealthy way to hide multiple files inside a single file without changing its file type. Antivirus might scan a .LNK file but not think to look for a PDF or a DAT file hidden deep inside its binary data.

3. Drops files to `%TEMP%`: `aio0.dat` (decoy PDF), `aio1.dat` (loader), `aio2.dat` (PowerShell script), `aio1+3.b+la+t` (final payload), and `aio03.bat`.

   - `%TEMP%` is your computer's junk drawer or staging area. It's a system environment variable that points to a temporary folder (usually `C:\Users\[YourName]\AppData\Local\Temp`).
   - Attackers use it:
      - It's Writeable: Programs (and malware) are allowed to create files here without needing special admin permissions.
      - It's Noisy: This folder is constantly filled with temporary files from legitimate programs, so the malicious files can blend in and look normal to a casual observer.
      - It's Often Ignored: Users rarely look here, and some security tools might not scan it as aggressively as other folders.
   - The PowerShell command from the LNK file extracts and saves several pieces of the malware puzzle to this `%TEMP%` junk drawer:
      - `aio0.dat` is the decoy PDF or the distraction. This is the legitimate-looking document (e.g., a news article, an invoice) that gets opened automatically. Its sole purpose is to make you think everything worked normally, so you don't get suspicious while the malware runs in the background.
      - `aio1.dat` is the loader. This file is encrypted (scrambled). Its job is to be loaded into the computer's memory by another program (the PowerShell script, `aio2.dat`). Once in memory, it will be decrypted and executed. It's called a "loader" because it loads the final stage of the malware.
      - `aio2.dat` is the PowerShell script, which is a text file containing PowerShell code. It doesn't run on its own; it's executed by the batch file (`aio03.bat`). Its job is complex:
         - It reads the encrypted loader (`aio1.dat`).
         - It decrypts it (unscrambles it) using a simple key (like `XOR 0x35`).
         - It performs advanced tricks to inject the decrypted code directly into the computer's memory, avoiding the hard drive where antivirus could detect it. This is called **fileless execution**.

4. `aio03.bat` runs PowerShell from `aio2.dat`, which decodes UTF-8 content and executes via `Invoke-Command`.

- 
  
  
  
  6. Final stage: `aio2.dat` reads `aio1.dat` (XOR-encrypted with key `0x35`/`'5'`), decrypts in memory, allocates executable buffer via `GlobalAlloc`/`VirtualProtect`, injects DLL reflectively, and runs ROKRAT.

- **Evasion**: Fileless execution minimizes footprints; LNK self-deletes post-execution.

#### Detailed Assessment



##### Campaign 2: North Korean Official Statement Decoy
- **Decoy Analysis**: A statement from Kim Yo-jong (Workers' Party of Korea Vice Director), dated July 28 (year unspecified, but contextually recent), reported by KCNA. It rejects South Korean reconciliation under President Lee Jae-myung's administration, criticizing inter-Korean talks as hypocritical and affirming confrontation over unity.
- **Targets**:
  - South Korean Government (Lee Jae-myung administration)
  - Ministry of Unification
  - Workers’ Party of Korea Central Committee
  - Korean Central News Agency (KCNA)
  - U.S.-South Korea Military Alliance
  - Asia-Pacific Economic Cooperation (APEC)
- **Infection Chain** (Similar to Campaign 1, with renamed files for evasion):
  1. LNK drops "file.doc" decoy and artifacts to %TEMP%: tony31.dat (encrypted EXE), tony32.dat (Base64 PowerShell), tony33.bat (obfuscated loader).
  2. tony33.bat decodes tony32.dat twice (bytes to UTF-8, then Base64), executes in memory.
  3. tony32.dat loads tony31.dat (XOR with 0x37/'7'), decrypts, injects via Windows APIs (GlobalAlloc, VirtualProtect, CreateThread).
  4. Decoded tony31.dat acts as dropper: Downloads "abs.tmp" from C2 (daily.alltop.asia/blog/article/d2.php), validates/deobfuscates, executes via PowerShell with -EncodedCommand, then deletes traces.
- **Exfiltration Mechanics**: Scans %TEMP% for files (e.g., in subdirs like {502C2E2E-...}), reads contents, packages as multipart/form-data HTTP POST mimicking Chrome PDF upload to C2 (up2.php). Includes victim hostname/timestamp; deletes files post-upload. Follow-up GET to d2.php downloads payloads; del2.php cleans server-side.

| Campaign | Decoy Type | Key Payloads | Encryption/Key | C2 Domain |
|----------|------------|--------------|----------------|-----------|
| 1 | Newsletter PDF | aio1.dat, aio2.dat, aio03.bat | XOR 0x35 ('5') | Cloud services (Dropbox, pCloud, Yandex) |
| 2 | Official Statement DOC | tony31.dat, tony32.dat, tony33.bat | XOR 0x37 ('7'), Base64 | daily.alltop.asia |

#### Malware Analysis: ROKRAT and Supporting Components
ROKRAT is the core implant, a modular RAT for espionage. Extracted EXE (from aio1.dat or tony31.dat) fingerprints the host (architecture, username, BIOS, anti-VM checks like VMware Tools detection) and performs privilege/environment validation (e.g., creating/deleting .dat in system dir).

- **Key Functions**:
  - **Screenshot Capture (sub_40E40B)**: Processes images in memory for exfiltration.
  - **Anti-Analysis (sub_40EA2C)**: Tests admin privileges; fails in sandboxes.
  - **Commands**: Single-char IDs (e.g., 1-4: Shellcode execution/log to r.txt; 5-9: PE download/execute as KB400928_doc.exe; C: Exfiltrate files by extension (doc, pdf, hwp); E: Run cmd.exe; H: Dir /A /S to %TEMP%\_TMP; i: Mark data ready; j/b: Self-terminate).
- **C2 Infrastructure**: Abuses cloud APIs for bidirectional comms (e.g., Dropbox /2/files/upload; pCloud /uploadfile; Yandex /upload). Obfuscated URLs like hxxps://api.dropboxapi[.]com/2/files/list_folder. In Campaign 2, HTTP to daily.alltop.asia mimics browser traffic (Chrome UA, multipart POST).

Advanced users: ROKRAT's modularity allows dynamic updates; monitor WinINet API calls for disguised beacons. XOR keys are simplistic, enabling quick decryption in tools like CyberChef.

#### MITRE ATT&CK Mapping
This campaign maps to multiple ATT&CK techniques, emphasizing initial access and evasion:

| Tactic | Technique | Description |
|--------|-----------|-------------|
| Initial Access | T1566.001 (Spear-phishing Attachment) | LNK in archives as PDF lures. |
| Execution | T1059.001 (PowerShell), T1204.001/002 (Malicious Link/File) | Embedded scripts, user execution. |
| Persistence | T1574.001 (DLL Hijacking), T1547.001 (Registry Run Keys) | Reflective DLL injection, autostart. |
| Privilege Escalation | T1055.001/009 (DLL/Proc Memory Injection), T1053.005 (Scheduled Tasks) | In-memory execution. |
| Defense Evasion | T1140 (Deobfuscate), T1070.004 (File Deletion), T1027.009/013 (Embedded/Encoded Payloads) | XOR/Base64, self-deletion. |
| Credential Access | T1056.002 (Keylogging: GUI) | Potential input capture. |
| Discovery | T1087.001 (Local Accounts), T1083 (File/Dir Discovery), T1082 (System Info) | Host fingerprinting, dir enumeration. |
| Collection | T1123 (Audio), T1005 (Local Data), T1113 (Screen Capture) | Screenshots, file grabs. |
| Command & Control | T1102.002 (Web Service: Bidirectional) | Cloud APIs, HTTP beacons. |
| Exfiltration | T1041 (Over C2 Channel) | Multipart POST to C2. |
| Impact | T1529 (Shutdown) | Self-termination. |

#### Indicators of Compromise (IOCs)
From the report, plus cross-verified hashes from VirusTotal scans:

| MD5 | File Name | Type |
|-----|-----------|------|
| 1aec7b1227060a987d5cb6f17782e76e | aio02.dat | PowerShell script |
| 591b2aaf1732c8a656b5c602875cbdd9 | aio03.bat | Batch loader |
| d035135e190fb6121faa7630e4a45eed | aio01.dat | Encrypted EXE |
| cc1522fb2121cf4ae57278921a5965da | *.zip | Delivery archive |
| 2dc20d55d248e8a99afbe5edaae5d2fc | tony31.dat | Encrypted dropper |
| f34fa3d0329642615c17061e252c6afe | tony32.dat | Base64 PowerShell |
| 051517b5b685116c2f4f1e6b535eb4cb | tony33.bat | Obfuscated loader |
| da05d6ab72290ca064916324cbc86bab | *.lnk | Malicious shortcuts |
| 443a00feeb3beaea02b2fbcd4302a3c9 | 북한이탈주민의 성공적인 남한정착을 위한 아카데미 운영.lnk | Defector-themed LNK |
| f6d72abf9ca654a20bbaf23ea1c10a55 | 국가정보와 방첩 원고.lnk | Intelligence manuscript LNK |

C2: hxxp://daily.alltop.asia/blog/article/up2.php, d2.php, del2.php; cloud endpoints as listed.

#### Protections and Practical Recommendations
Seqrite detects these as Trojan.49901.GC and Trojan.49897.GC. For broader defense:
- **Beginner Tips**: Use antivirus with behavior monitoring (e.g., enable PowerShell logging via Group Policy: `Turn on PowerShell Script Block Logging`). Scan archives before extraction; verify sender authenticity.
- **Advanced Strategies**: Deploy EDR tools (e.g., CrowdStrike, Microsoft Defender) to hook APIs like VirtualProtect. Hunt for IOCs using YARA rules for XOR loops or LNK offsets. Network: Block cloud API abuse via proxy rules; monitor for multipart POSTs with mismatched MIME (application/pdf but non-PDF content).
- **Organizational Best Practices**: Train on LNK risks (they bypass some PDF filters); segment networks for high-value targets like research institutes. For South Korean entities, align with KISA guidelines on APT monitoring.

In summary, Operation HanKook Phantom reveals APT37's adaptability, but proactive defenses can thwart it. As North-South tensions persist, expect more such campaigns—vigilance is key.

#### Key Citations
- Seqrite Labs Report: "Operation HanKook Phantom: North Korean APT37 targeting South Korea" (Primary source PDF).
- Mandiant: "APT37: North Korean Espionage Targeting Korean Defectors" (2024, confirms similar lures).
- Microsoft Threat Intelligence: "North Korea's Cyber Operations in 2025" (Details cloud C2 patterns).
- CrowdStrike Global Threat Report 2025 (APT37 evolution and TTPs).
- VirusTotal: IOC hashes verified (e.g., aio01.dat MD5 d035135e190fb6121faa7630e4a45eed).
