# APT28 Signal Malware (2025)

Recently, the Computer Emergency Response Team of Ukraine (CERT-UA) issued a warning about a sophisticated attack campaign orchestrated by the Russia-linked APT28 (also known as UAC-0001) hacking group. This group is using the Signal messaging app and phishing emails to deliver two new malware families, BEARDSHELL and COVENANT, targeting Ukrainian organizations.

<div style="text-align: center;">
  <img src="assets/images/bug.png" width="120">
</div>

## Who is APT28?

APT28 is a well-known hacking group believed to be linked to Russia. They've been active for years, targeting governments, militaries, and organizations worldwide, often with political motives. Their attacks are advanced and persistent, earning them the label "Advanced Persistent Threat" (APT). In this case, they're focusing on Ukrainian government entities, exploiting trust in communication platforms like Signal and vulnerabilities in email systems.

## How The Attack Started

CERT-UA first detected signs of this attack in March-April 2024 while responding to a compromised Windows computer. They found two malicious tools: **BEARDSHELL**, a backdoor malware, and **SLIMAGENT**, a program that takes screenshots of the victim's screen. At the time, they didn't know how the infection began.

Fast forward to 2025, when ESET, a Slovak cybersecurity company, shared intel about unauthorized access to a Ukrainian government email account (ending in "gov.ua"). This clue helped CERT-UA uncover the full attack chain, including the initial infection method and the use of a second malware called **COVENANT**. ESET's earlier report also pointed to APT28 exploiting weaknesses in webmail software like Roundcube to target Ukrainian systems.

## How the Signal-Based Attack Works

One of the most alarming aspects of this campaign is the use of the Signal messaging app, which is known for its privacy and security. Here's how the attack unfolds:

1. **Delivery via Signal**: Hackers send a malicious Microsoft Word document named "Акт.doc" (which translates to "Act.doc" in English) through Signal messages. This file appears legitimate but contains hidden malicious code.

2. **Macro Activation**: When the victim opens the Word document, it prompts them to enable macros (a feature in Microsoft Office that automates tasks). If macros are enabled, the attack proceeds.

3. **Payload Drop**: The macro installs two files on the victim's computer:
   - A malicious DLL file called "ctec.dll" (DLLs are small programs that other applications can use).
   - A PNG image called "windows.png" (this isn't a real image but contains hidden malicious code called **shellcode**).

4. **Persistence Mechanism**: The macro modifies the Windows Registry to ensure "ctec.dll" runs every time the victim opens Windows File Explorer.

5. **COVENANT Deployment**: When "ctec.dll" runs, it loads the shellcode from "windows.png," launching the **COVENANT** malware framework. COVENANT stays in the computer's memory, making it harder to detect.

6. **BEARDSHELL Installation**: COVENANT downloads additional files that install **BEARDSHELL**, a backdoor that gives hackers control over the computer.

### What is BEARDSHELL?

BEARDSHELL is a malware written in C++. It's designed to:
- Download and run PowerShell scripts.
- Send the results of those scripts back to the hackers using the Icedrive API (a cloud storage service).
- Act as a backdoor, allowing hackers to remotely control the infected computer.

### What is COVENANT?

COVENANT is a malware framework that operates in memory, making it stealthy and difficult to detect with traditional antivirus software. Its main job is to fetch additional malicious files to install BEARDSHELL, completing the infection process.

## Phishing Email Attack

In addition to the Signal-based attack, APT28 is targeting outdated Roundcube webmail servers (a popular email platform) with phishing emails. These emails are crafted to look like legitimate news articles from a Ukrainian publication called NV (nv.ua). Here's how this attack works:

1. **Phishing Email**: The email contains a hidden exploit (malicious code) for a cross-site scripting (XSS) vulnerability in Roundcube, specifically CVE-2020-35730.

2. **JavaScript Execution**: When the victim opens the email, the exploit runs two JavaScript files, "q.js" and "e.js":
   - **e.js**: Steals the victim's email address book and session cookies (data that keeps you logged into websites). It also creates a mailbox rule to forward all incoming emails to a hacker-controlled email address.
   - **q.js**: Exploits an SQL injection flaw in Roundcube (CVE-2021-44026) to extract data from the email server's database.

3. **Additional Exploit**: CERT-UA found a third JavaScript file, "c.js," which exploits another Roundcube flaw (CVE-2020-12641) to run arbitrary commands on the mail server.

4. **Widespread Targeting**: Over 40 Ukrainian organizations received these phishing emails, showing the scale of the campaign.

## Why These Attacks Are Dangerous

- **Trusted Platforms**: Using Signal, a secure messaging app, makes victims less suspicious of the malicious file.
- **Social Engineering**: Phishing emails disguised as news articles exploit trust in familiar sources.
- **Exploiting Vulnerabilities**: Targeting outdated Roundcube servers shows how hackers take advantage of unpatched software.
- **Stealthy Malware**: COVENANT's memory-resident nature and BEARDSHELL's use of legitimate services like Icedrive make detection challenging.
- **Data Theft and Control**: The malware steals sensitive data (emails, contacts, cookies) and gives hackers full control over infected systems.

## How to Protect Yourself and Your Organization

1. **Be Cautious with Attachments**:
   - Don't open Word documents from unknown sources, especially if they ask you to enable macros.
   - Verify the sender's identity, even if the message comes from a trusted app like Signal.

2. **Keep Software Updated**:
   - Ensure your webmail software (like Roundcube) is running the latest version to patch vulnerabilities like CVE-2020-35730, CVE-2021-44026, and CVE-2020-12641.
   - Regularly update your operating system and antivirus software.

3. **Monitor Network Traffic**:
   - Organizations should watch for suspicious connections to domains like "app.koofr[.]net" and "api.icedrive[.]net," which are used by the malware.

4. **Use Strong Security Practices**:
   - Enable two-factor authentication (2FA) on your email accounts.
   - Train employees to recognize phishing emails and social engineering tactics.

5. **Disable Macros by Default**:
   - Configure Microsoft Office to disable macros or prompt you before running them.

6. **Backup Your Data**:
   - Regularly back up important files to an offline or secure cloud storage to recover quickly if attacked.

## Author

### Iftekhar Mahmud

- Email: iftekmahmud@protonmail.com
- Blog: [https://iftekmahmud.github.io/blog/](https://iftekmahmud.github.io/blog/)
- LinkedIn: https://www.linkedin.com/in/iftekmahmud/
